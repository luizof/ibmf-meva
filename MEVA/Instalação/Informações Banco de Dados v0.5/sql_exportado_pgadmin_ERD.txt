-- This script was generated by the ERD tool in pgAdmin 4.
-- Please log an issue at https://redmine.postgresql.org/projects/pgadmin4/issues/new if you find any bugs, including reproduction steps.
BEGIN;


CREATE TABLE IF NOT EXISTS public.calibracoes
(
    id integer NOT NULL DEFAULT nextval('calibracoes_id_seq'::regclass),
    data_hora_calibracao timestamp without time zone,
    valor_distancia double precision,
    posicao_id integer,
    maquina_id integer,
    CONSTRAINT calibracoes_pkey PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS public.maquinas
(
    id integer NOT NULL DEFAULT nextval('maquinas_id_seq'::regclass),
    nome character varying(255) COLLATE pg_catalog."default",
    descricao text COLLATE pg_catalog."default",
    CONSTRAINT maquinas_pkey PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS public.medicoes
(
    id integer NOT NULL DEFAULT nextval('medicoes_id_seq'::regclass),
    data_hora timestamp without time zone,
    maquina_id integer,
    posicao_leitura_id integer,
    valor_medicao_superior double precision,
    valor_medicao_inferior double precision,
    CONSTRAINT medicoes_pkey PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS public.posicoes
(
    id integer NOT NULL DEFAULT nextval('posicoes_id_seq'::regclass),
    nome_posicao character varying(255) COLLATE pg_catalog."default",
    descricao_posicao text COLLATE pg_catalog."default",
    CONSTRAINT posicoes_pkey PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS public.sensores
(
    id integer NOT NULL DEFAULT nextval('sensores_id_seq'::regclass),
    endereco_ip character varying(255) COLLATE pg_catalog."default",
    maquina_id integer,
    posicao_id integer,
    e_superior boolean,
    status character varying(255) COLLATE pg_catalog."default",
    CONSTRAINT sensores_pkey PRIMARY KEY (id)
);

ALTER TABLE IF EXISTS public.calibracoes
    ADD CONSTRAINT calibracoes_posicao_id_fkey FOREIGN KEY (posicao_id)
    REFERENCES public.posicoes (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.calibracoes
    ADD CONSTRAINT fk_maquina_id FOREIGN KEY (maquina_id)
    REFERENCES public.maquinas (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.medicoes
    ADD CONSTRAINT medicoes_maquina_id_fkey FOREIGN KEY (maquina_id)
    REFERENCES public.maquinas (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.medicoes
    ADD CONSTRAINT medicoes_posicao_leitura_id_fkey FOREIGN KEY (posicao_leitura_id)
    REFERENCES public.posicoes (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.sensores
    ADD CONSTRAINT sensores_maquina_id_fkey FOREIGN KEY (maquina_id)
    REFERENCES public.maquinas (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS public.sensores
    ADD CONSTRAINT sensores_posicao_id_fkey FOREIGN KEY (posicao_id)
    REFERENCES public.posicoes (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;

END;